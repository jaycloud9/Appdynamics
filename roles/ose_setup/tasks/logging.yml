---
- name: "Import logging template"
  shell: "oc apply -n openshift -f /usr/share/openshift/examples/infrastructure-templates/enterprise/logging-deployer.yaml"
#- name: "Create logging project"
#  shell: 'oadm new-project logging --node-selector=""'
- name: "Switch to logging project"
  shell: "oc project logging"
- name: "Create Service accounts"
  shell: "oc new-app logging-deployer-account-template"
- name: "Allow Deployer SA to create tokens"
  shell: "oadm policy add-cluster-role-to-user oauth-editor system:serviceaccount:logging:logging-deployer"
- name: "Enable fluetd to be privilleged"
  shell: "oadm policy add-scc-to-user privileged system:serviceaccount:logging:aggregated-logging-fluentd"
- name: "Enable to read Pod metadata"
  shell: "oadm policy add-cluster-role-to-user cluster-reader system:serviceaccount:logging:aggregated-logging-fluentd"
- name: "Create ConfigMap"
  shell: "oc create configmap logging-deployer --from-literal kibana-hostname=kibana.apps.cluster1.temenos.cloud --from-literal public-master-url=https://cluster1.temenos.cloud --from-literal es-cluster-size=3 --from-literal es-instance-ram=8G"
- name: "Create OC Secret"
  shell: "oc create secret generic logging-deployer"
- name: "install logging"
  shell: "oc new-app logging-deployer-template"
